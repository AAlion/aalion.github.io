---
layout: post
title: '线程的工作内存'
categories: Java
date: 2019-12-08 00:00:01
tags:
    - Java
    - concurrency
    - null
---

1)<JVM虚拟机>：Java线程之间的通信由Java内存模型（JMM）控制，JMM决定一个线程对共享变量的写入何时对另一个线程可见。从抽象的角度来看，JMM定义了线程和主内存之间的抽象关系：线程之间的共享变量存储在主内存（main memory）中，每个线程都有一个私有的本地内存（local memory），本地内存中存储了该线程以读/写共享变量的副本。本地内存是JMM的一个抽象概念，并不真实存在，它涵盖了缓存，写缓冲区，寄存器以及其他的硬件和编译器优化。
2)解释
解释下上文所说的主内存和本地内存：
首先，JVM将内存组织为主内存和工作内存两个部分。
主内存主要包括本地方法区和堆。每个线程都有一个工作内存，工作内存中主要包括两个部分，一个是属于该线程私有的栈和对主存部分变量拷贝的寄存器(包括程序计数器PC和cup工作的高速缓存区)。
①所有的变量都存储在主内存中(虚拟机内存的一部分)，对于所有线程都是共享的。
②每条线程都有自己的工作内存，工作内存中保存的是主存中某些变量的拷贝，线程对变量的所有操作都必须在工作内存中进行，而不能直接读写主内存中的变量。
③线程之间无法直接访问对方的工作内存中的变量，线程间变量的传递均需要通过主内存来完成。

ref：https://www.jianshu.com/p/679ad52eca05
